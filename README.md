### 使用教程 - 自动答题脚本

该教程将指导你如何运行和适配自动答题脚本，其中`requirements.txt`已经准备好。通过该教程，你可以学习如何获取手机截图、比对图像、识别题目文本并选择正确答案，最后自动模拟点击操作。本教程还包括如何适配不同屏幕和裁切图像的步骤。`test.png`是初始的对比图，如你上传的文件所示。

#### 1. 环境准备

1. 安装必要依赖:
   - 确保你已经安装了Python以及`PaddleOCR`库。可以使用以下命令来安装需要的依赖：
     ```bash
     pip install -r requirements.txt
     ```

#### 2. 设备连接与ADB设置

1. **连接你的安卓设备：**
   - 确保你的电脑已经通过USB连接手机，并开启了手机的开发者模式和USB调试。
   - 运行以下命令，确认你的设备已经连接：
     ```bash
     adb devices
     ```

2. **确保ADB能够截取并保存截图：**
   - 使用以下命令进行测试，查看是否能够成功截取手机屏幕并将截图保存到本地：
     ```bash
     adb shell screencap -p /sdcard/Download/screenshot.png
     adb pull /sdcard/Download/screenshot.png ./screenshot.png
     ```

#### 3. 适配不同屏幕

要使脚本适配不同分辨率的手机屏幕，需要手动调节裁切区域。默认脚本中使用了默认手机分辨率下的坐标，你可以通过以下步骤调整适配不同的屏幕。

1. **确定图像比对区域：**
   - 裁切的内容为屏幕上方数字部分（用于图像比对），即从`y=65`到`y=109`的区域。你可以通过修改以下代码来调整这个区域：
     ```python
     #这个是首次截取的图片，用于后续对比
     img1_cropped = img1[65:109, 320:399]  # 裁剪左上角坐标，右上角坐标
     # 这个是实时截取的图片，对比前一张确认题目是否变化
     img2_cropped = img2[65:109, 320:399]  # 根据不同设备分辨率调整
     ```
   
2. **手动裁切并测试：**
   - 可以使用如下命令获取屏幕分辨率，并调整脚本中的裁切坐标：
     ```bash
     adb shell wm size
     ```

3. **对比初始截图**：
   - 将`test.png`上传到指定位置，并作为对比图。该截图用于比对后续实时获取的图片，以检测是否有变化。如果需要，可以将初始对比图，的路径替换为你需要的文件：
     ```python
     last_image = cv2.imread("test.png")
     ```

#### 4. 运行脚本

1. **执行主程序：**
   在确保设备连接正常、依赖安装完毕的情况下，执行以下命令来运行脚本：
   ```bash
   python main.py
   ```

2. **自动化答题流程：**
   - 脚本会通过`ADB`自动获取手机屏幕截图，识别题目，使用OCR技术提取题目和选项文本，并通过大模型进行判断，最后模拟点击选择答案。
   - 当一轮答题结束时，脚本会自动发起新的答题，直到手动停止。

#### 5. 调试与测试

1. **手动调试**：
   - 如果在图像比对部分检测不到变化，可以手动调整裁切区域。每次更改后，可以通过如下代码打印图像差异来调试：
     ```python
     print(f"图像差异值: {mean_diff}")
     ```
   
2. **运行测试**：
   - 你可以通过本地调试，确保脚本在多个设备上能够正常运行。将截取的手机图片保存下来进行逐步测试。

---

### 重要提示

- 请确保脚本仅用于合法用途，如参加线上答题练习或测试。滥用该脚本可能会违反平台的相关政策。